<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PoppyPages | Blog Post</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;700;800&family=Inter:wght@400;500;600&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>

    <header class="glass-header">
        <div class="container">
            <nav class="nav-container">
                <a href="index" class="logo-container">
                    <img src="assets/logo_final.png" alt="PoppyPages Logo" class="brand-logo-img">
                </a>
                <div class="nav-links">
                    <a href="index#about">About us</a>
                    <a href="blog">Blog</a>
                    <a href="index#leads" class="btn btn-sm btn-primary">Free Audit + Growth Pack</a>
                </div>
            </nav>
        </div>
    </header>

    <main class="container" style="padding-top: 140px; max-width: 800px;">
        <article id="post-content" class="glass-card" style="padding: 60px; min-height: 400px;">
            <p>Loading post...</p>
        </article>

        <div style="margin-top: 40px;">
            <a href="blog" class="btn btn-secondary">← Back to Blog</a>
        </div>
    </main>

    <footer>
        <div class="container center-text">
            <p class="copyright">© 2026 PoppyPages. All rights reserved.</p>
        </div>
    </footer>

    <script>
        async function fetchPost() {
            const urlParams = new URLSearchParams(window.location.search);
            const slug = urlParams.get('slug');
            if (!slug) {
                window.location.href = 'blog';
                return;
            }

            try {
                const response = await fetch(`/api/post?slug=${slug}`);
                const post = await response.json();
                renderPost(post);
            } catch (err) {
                console.error("Error fetching post:", err);
                document.getElementById('post-content').innerHTML = '<h1>Post not found</h1><p>The post you are looking for may have been removed.</p>';
            }
        }

        function renderPost(post) {
            if (!post || post.error) {
                document.getElementById('post-content').innerHTML = '<h1>Post not found</h1>';
                return;
            }

            document.title = `PoppyPages | ${post.title}`;
            document.getElementById('post-content').innerHTML = `
                ${post.thumbnail ? `<img src="${post.thumbnail}" alt="${post.title}" style="width: 100%; height: 400px; object-fit: cover; border-radius: 15px; margin-bottom: 30px;">` : ''}
                <span class="blog-date" style="display:block; margin-bottom: 20px;">${new Date(post.date).toLocaleDateString()}</span>
                <h1 class="gradient-text" style="font-size: 3rem; margin-bottom: 30px;">${post.title}</h1>
                <div class="post-body" style="font-size: 1.1rem; line-height: 1.8; color: var(--text-main);">
                    ${post.content}
                </div>
            `;
        }

        fetchPost();
    </script>
</body>

</html>